;/*FB_PKG_DELIM*/

__d("BrowserPushCommands",[],(function(t,n,r,o,a,i){var e="browser_push_ack",l="browser_push_redirect",s="browser_push_window_visible",u="should_reuse_m_dot_com_tab",c="should_reuse_m_dot_com_tab_response",d={ACK:e,REDIRECT:l,WINDOW_VISIBLE:s,SHOULD_REUSE_M_DOT_COM_TAB:u,SHOULD_REUSE_M_DOT_COM_TAB_RESPONSE:c};i.default=d}),66);
__d("NotifUserSettingActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("6085"),s=o("FalcoLoggerInternal").create("notif_user_setting_action",e),u=s;l.default=u}),98);
__d("BrowserPushMessageHandler",["BrowserPushCommands","EventListener","URI","URISchemes","cr:6901","isFacebookURI"],(function(t,n,r,o,a,i,l){var e,s;function u(t){if(t.data.command&&t.data.command===r("BrowserPushCommands").REDIRECT){if(typeof window.onbeforeunload=="function"&&window.onbeforeunload()===void 0)t.ports[0].postMessage({command:r("BrowserPushCommands").ACK,success:!0});else{t.ports[0].postMessage({command:r("BrowserPushCommands").ACK,success:!1});return}var a=t.data.uri;if(/^([^.:/?#]+):/.test(a)&&!(s||(s=o("URISchemes"))).isAllowed(/^([^.:/?#]+):/.exec(a)[1])||!r("isFacebookURI")(new(e||(e=r("URI")))(a)))throw new Error("goURI: URI scheme rejected, URI: "+a);n("cr:6901")(a)&&(window.location.href=a)}}var c={registerRedirectHandler:function(){r("EventListener").listen(window,"message",function(e){e.origin===""&&u(e)}),navigator.serviceWorker&&navigator.serviceWorker.addEventListener&&(navigator.serviceWorker.addEventListener("message",function(e){(navigator.serviceWorker&&navigator.serviceWorker.controller&&e.target&&e.target.controller&&e.target.controller===navigator.serviceWorker.controller||new RegExp("^"+window.location.protocol+"//"+window.location.host+"$").test(e.origin))&&u(e)}),navigator.serviceWorker.addEventListener("message",function(e){var t,n=(t=e.data)!=null?t:{},o=n.command;if(o===r("BrowserPushCommands").SHOULD_REUSE_M_DOT_COM_TAB){var a=[].concat(e==null?void 0:e.ports),i={command:r("BrowserPushCommands").SHOULD_REUSE_M_DOT_COM_TAB_RESPONSE,value:!1};a==null||a[0].postMessage(i)}}))}},d=c;l.default=d}),98);
__d("BrowserPushVisibilityChanger",["BrowserPushCommands","ClientServiceWorkerMessage","Visibility"],(function(t,n,r,o,a,i,l){function e(){new(r("ClientServiceWorkerMessage"))(r("BrowserPushCommands").WINDOW_VISIBLE,null).sendViaController()}var s={listenForVisibility:function(){r("Visibility").isHidden()||e(),r("Visibility").addListener(r("Visibility").VISIBLE,e)}},u=s;l.default=u}),98);
__d("NuxWizardFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1039"),s=o("FalcoLoggerInternal").create("nux_wizard",e),u=s;l.default=u}),98);
__d("MPushPermissionUtil",["BanzaiLogger","NuxWizardFalcoEvent","gkx"],(function(t,n,r,o,a,i,l){function e(e,t){t===void 0&&(t=!1);var n=r("gkx")("21006");if(n&&r("BanzaiLogger").log("ChromePushPermissionEventsLoggerConfig",{event:e}),t){var o=null,a="step";e==="allow"?(o="allow",a="conversion"):e==="deny"?o="deny":e==="install_ignore"?o="ignore":e==="turn_on_attempt"&&(o="show_browser_dialog"),o!==null&&r("NuxWizardFalcoEvent").log(function(){return{event:o,event_type:a,platform:"mobile",step:"turn_on_notification"}})}}l.logEvent=e}),98);
__d("PushRegistrationUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=e.endpoint;return"subscriptionId"in e&&!new RegExp("/"+e.subscriptionId+"$").test(t)&&(t+="/"+e.subscriptionId),t}function l(t,n){var r=e(t),o=null;return t.toJSON?o=t.toJSON().keys:t.keys&&(o=t.keys),{app_id:n,push_endpoint:r,subscription_keys:JSON.stringify(o)}}i.normalizeSubscriptionEndpoint=e,i.setupPushRegistrationData=l}),66);
__d("ServiceWorkerRegistration",["ClientServiceWorkerMessage","EventListener","Promise","Run","promiseDone"],(function(t,n,r,o,a,i){var e,l=!!navigator.serviceWorker,s={};function u(){var e=navigator.serviceWorker;if(!l||!e)throw new Error("serviceWorker is not supported in this browser");return e}var c={isSupported:function(){return l},registerWorkerIfUnregisteredAfterDD:function(t){n("Run").onAfterLoad(function(){n("promiseDone")(c.registerWorkerIfUnregistered(t))})},registerWorkerIfUnregistered:function(r){if(s[r])return s[r];var t=u(),o=s[r]=new(e||(e=n("Promise")))(function(o,a){n("promiseDone")(c.getWorkerRegistration(r),function(i){if(i)o(i);else{var l=n("EventListener").listen(window,"message",function(e){var t;(e==null||(t=e.data)==null?void 0:t.command)==="ServiceWorkerInstallError"&&a()});n("promiseDone")((e||(e=n("Promise"))).resolve(t.register(r,{updateViaCache:"all"})),function(){l.remove(),n("promiseDone")((e||(e=n("Promise"))).resolve(t.ready),o)})}})});return o},unregisterControllingWorker:function(){return new(e||(e=n("Promise")))(function(e,t){var r=new(n("ClientServiceWorkerMessage"))("unregister",{},function(){e(!0)});r.sendViaController()})},getWorkerRegistration:function(t){var e=u();return e.getRegistration(t)},isAWorkerActivated:function(){return!navigator.serviceWorker||!navigator.serviceWorker.getRegistration?(e||(e=n("Promise"))).resolve(!1):navigator.serviceWorker.getRegistration().then(function(e){return!!(e&&e.active)})}},d=c;i.default=d}),66);
__d("XAsyncPushMuteController",["XController"],(function(t,n,r,o,a,i){a.exports=n("XController").create("/notifications/settings/push/mute/",{appid:{type:"Int",required:!0},push_endpoint:{type:"String",required:!0},mute_for:{type:"Enum",enumType:0}})}),null);
__d("XAsyncPushMuteStateController",["XController"],(function(t,n,r,o,a,i){a.exports=n("XController").create("/notifications/settings/push/mute/state/",{appid:{type:"Int",required:!0},push_endpoint:{type:"String",required:!0}})}),null);
__d("PushRegistration",["BrowserPushMessageHandler","BrowserPushPubKey","BrowserPushVisibilityChanger","MPushPermissionUtil","Promise","PushRegistrationUtils","ServiceWorkerRegistration","XAsyncPushMuteController","XAsyncPushMuteStateController","emptyFunction","gkx","promiseDone"],(function(t,n,r,o,a,i){var e,l=window.Notification,s=new Map,u=65,c=4,d=(function(){"use strict";function t(e,n){this.$3=e,this.appID=n,!t.$1&&!t.$2&&(t.$1=!1,t.$2=!1)}t.get=function(n,r){if(s.has(r))return s.get(r);var e=new t(n,r);return s.set(r,e),e};var r=t.prototype;return r.getPushSubscription=function(){var r=this;return new(e||(e=n("Promise")))(function(e,o){t.pushPermissionIsDenied()&&(n("MPushPermissionUtil").logEvent("permission_denied_or_blocked"),o(new Error("No permission or not supported"))),n("ServiceWorkerRegistration").getWorkerRegistration(r.$3).then(function(t){if(!t){e(null);return}t.pushManager.getSubscription().then(function(t){e(t)}).catch(o)}).catch(o)})},r.$4=function(t,r,o){var e=t.getURIBuilder().getURI(),a=new r(e);a.setData(n("PushRegistrationUtils").setupPushRegistrationData(o,this.appID)),a.setMethod("post"),a.send()},r.getMutedUntilInServer=function(r){var t=this;return new(e||(e=n("Promise")))(function(e,o){t.getPushSubscription().then(function(a){if(a){var i=n("PushRegistrationUtils").normalizeSubscriptionEndpoint(a),l=n("XAsyncPushMuteStateController").getURIBuilder().setString("push_endpoint",i).setInt("appid",t.appID).getURI(),s=new r(l);s.listen("done",function(t){e(t.payload.muteUntilTimestampSec)}),s.send()}else o("cannot check mute status for unsubscribed endpoint")}).catch(o)})},r.muteNotifications=function(r,o){var t=this;return new(e||(e=n("Promise")))(function(e,a){t.getPushSubscription().then(function(i){if(i){var l=n("PushRegistrationUtils").normalizeSubscriptionEndpoint(i),s=n("XAsyncPushMuteController").getURIBuilder().setEnum("mute_for",r).setString("push_endpoint",l).setInt("appid",t.appID).getURI(),u=new o(s);u.setMethod("POST"),u.listen("done",function(t){r!==0&&t.payload.muteUntilTimestampSec===0?a("operation failed in server"):e(t.payload.muteUntilTimestampSec)}),u.send()}else a("no subscription found")}).catch(a)})},r.getSubscription=function(){var t=this;return new(e||(e=n("Promise")))(function(e,r){t.getPushSubscription().then(function(t){e(t?n("PushRegistrationUtils").normalizeSubscriptionEndpoint(t):null)}).catch(r)})},r.maybeRegisterPushAgain=function(r,o){var t=this;return new(e||(e=n("Promise")))(function(e,a){t.getPushSubscription().then(function(a){a?(t.$4(r,o,a),e(n("PushRegistrationUtils").normalizeSubscriptionEndpoint(a))):e(null)}).catch(function(){e(null)})})},r.$5=function(o,a,i){var r=this;return new(e||(e=n("Promise")))(function(e,n){if(t.$2&&!i){n(new Error("sending disable info already"));return}t.$2=!0;var l=o.getURIBuilder().getURI(),s=new a(l.toString());s.setData({appid:r.appID,from_browser_settings:i}),s.setMethod("post"),s.listen?(s.listen("finally",e),s.listen("fail",function(){t.$2=!1,n()})):s.setErrorHandler&&s.setHandler?(s.setErrorHandler(function(){t.$2=!1,n()}),s.setHandler(e)):e(),s.send()})},r.isPushRegistered=function(o,a,i,l,s,u){var r=this;return s===void 0&&(s=!1),u===void 0&&(u=!1),n("BrowserPushMessageHandler").registerRedirectHandler(),new(e||(e=n("Promise")))(function(e,c){r.getPushSubscription().then(function(c){e(!!c||o&&!t.pushPermissionIsPending());var d=r.$6(),m=r.$7(c,d);if(c&&m)s?r.$4(a,l,c):n("BrowserPushVisibilityChanger").listenForVisibility();else if((!c||!m)&&o){var p=r.$8(c,!m);t.pushPermissionIsOn()?p.then(function(e){return r.registerPush(a,l,u)}).catch(function(){}):n("promiseDone")(r.$5(i,l,!1))}}).catch(function(){o&&n("promiseDone")(r.$5(i,l,!1)),u&&n("promiseDone")(n("ServiceWorkerRegistration").unregisterControllingWorker()),c()})})},r.$8=function(r,o){return r&&o?r.unsubscribe().then(function(e){return!!e}).catch(function(e){throw new Error("Unsubscribing invalid PushToken failed")}):(e||(e=n("Promise"))).resolve(!0)},r.$7=function(t,r){if(!n("gkx")("21098"))return!0;if(!t)return!1;var e=this.$9(t);return r?e?this.$10(t,n("BrowserPushPubKey").appServerKey):!1:!e},r.$10=function(t,n){var e=this.$11(t);if(!e)return!1;var r=new Uint8Array(e),o=window.btoa(String.fromCharCode.apply(null,r)),a=o.replace("/","_").replace("=","");return a===n},r.$9=function(t){var e=this.$11(t);if(e&&e.byteLength===u){var n=new Uint8Array(e);return n[0]===c}return!1},r.$11=function(t){return t&&t.options&&t.options.applicationServerKey?t.options.applicationServerKey:null},r.$12=function(){return new(e||(e=n("Promise")))(function(e,t){l.requestPermission(e)})},r.registerPushAndWaitForEndpoint=function(r,o,a){var t=this;return a===void 0&&(a=!1),new(e||(e=n("Promise")))(function(e,n){t.$13(r,o,!0,null,a).then(function(t){if(typeof t!="string"){n(new Error("registerPushImpl did not return an endpoint"));return}e(t)}).catch(n)})},r.registerPushOnKaiOS=function(r,o,a){var t=this;return new(e||(e=n("Promise")))(function(e,i){n("promiseDone")(a.waitForKaiOS(),function(){a.registerPush(function(a){var i=JSON.parse(a.get("push_endpoint"));t.$4(r,o,i),e(n("PushRegistrationUtils").normalizeSubscriptionEndpoint(i))})})})},r.registerPush=function(t,r,o,a){return o===void 0&&(o=!1),a===void 0&&(a=n("emptyFunction")),this.registerPushWithFinishedCallBack(t,r,a,o)},r.registerPushWithFinishedCallBack=function(r,o,a,i){var t=this;return i===void 0&&(i=!1),new(e||(e=n("Promise")))(function(e,n){t.$13(r,o,!1,a,i).then(function(t){if(typeof t!="boolean"){n(new Error("registerPushImpl did not return a boolean"));return}e(t)}).catch(n)})},r.$13=function(o,a,i,l,s){var r=this;return t.$1?new(e||(e=n("Promise")))(function(e,t){t(new Error("registering already"))}):self.PushManager?(t.$1=!0,new(e||(e=n("Promise")))(function(u,c){var d=n("ServiceWorkerRegistration").registerWorkerIfUnregistered(r.$3),m=r.$12();(e||(e=n("Promise"))).all([d,m]).then(function(e){var d=e[0];if(!t.pushPermissionIsOn())throw s&&n("promiseDone")(d.unregister()),new Error("Push permission was denied");i||u(!0);var m=n("BrowserPushPubKey").appServerKey,p=r.$6(),_=p?{userVisibleOnly:!0,applicationServerKey:m}:{userVisibleOnly:!0};d.pushManager.subscribe(_).then(function(e){i&&u(n("PushRegistrationUtils").normalizeSubscriptionEndpoint(e)),r.$4(o,a,e),l&&l(),n("BrowserPushVisibilityChanger").listenForVisibility()}).catch(function(e){t.$1=!1,s&&n("promiseDone")(d.unregister()),c(e)})}).catch(function(e){t.$1=!1,c(e)})})):(e||(e=n("Promise"))).reject(new Error("PushManager not found."))},r.$6=function(){var e=n("BrowserPushPubKey").appServerKey;return n("gkx")("21099")&&e!=null&&e!=""},r.unregisterPushAndSWOnKaiOS=function(r,o,a,i){var t=this;return new(e||(e=n("Promise")))(function(e,n){t.$5(r,o,i).then(function(){a.unregisterPush(),e()}).catch(n)})},r.unregisterPushAndSW=function(r,o){var t=this;return new(e||(e=n("Promise")))(function(e,a){t.$5(r,o,!0).then(function(){n("promiseDone")(n("ServiceWorkerRegistration").unregisterControllingWorker(),e)}).catch(a)})},r.unregisterPushOnly=function(r,o){var t=this;return new(e||(e=n("Promise")))(function(e,n){t.getPushSubscription().then(function(a){a?a.unsubscribe().then(t.$5(r,o,!0)).then(function(){e(!0)}).catch(n):n()}).catch(n)})},t.pushPermissionIsPending=function(){return window.Notification&&window.Notification.permission==="default"},t.pushPermissionIsOn=function(){return window.Notification&&window.Notification.permission==="granted"},t.pushPermissionIsDenied=function(){return window.Notification&&window.Notification.permission==="denied"},t})();a.exports=d}),null);
__d("XBrowserPushDisabledController",["XController"],(function(t,n,r,o,a,i){a.exports=n("XController").create("/notifications/client/push/disabled/",{})}),null);
__d("XBrowserPushXOutController",["XController"],(function(t,n,r,o,a,i){a.exports=n("XController").create("/notifications/client/push/xout/",{})}),null);
__d("XPushRegisterServiceWorkerController",["XController"],(function(t,n,r,o,a,i){a.exports=n("XController").create("/push/register/service_worker/",{})}),null);
__d("incognito",["UserAgent","WebStorage"],(function(t,n,r,o,a,i,l){"use strict";var e;async function s(){var t=window.RequestFileSystem||window.webkitRequestFileSystem;return t?new Promise(function(e){return t(window.TEMPORARY,10,function(){return e(!1)},function(){return e(!0)})}):r("UserAgent").isBrowser("IE >= 10")||r("UserAgent").isBrowser("Edge")?!window.indexedDB:r("UserAgent").isBrowser("Firefox >= 16")?new Promise(function(e){var t=window.indexedDB.open("__test__");t.onsuccess=function(){return e(!1)},t.onerror=function(t){t.preventDefault(),e(!0)}}):r("UserAgent").isBrowser("Safari")?!(e||(e=r("WebStorage"))).getLocalStorage():!1}l.default=s}),98);
__d("BrowserPushDirectPromptInstallerComet",["AsyncRequest","BanzaiLogger","NotifUserSettingActionFalcoEvent","Promise","PushNotificationsEventEmitter","PushRegistration","QE2Logger","XBrowserPushDisabledController","XBrowserPushXOutController","XPushRegisterServiceWorkerController","incognito","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e,t,n){n===void 0&&(n="prompt");var o=babelHelpers.extends({appID:t,event:e,surface:n},s);r("BanzaiLogger").log("BrowserPushLoggerConfig",o)}function d(e,t,n,o,a,i){r("NotifUserSettingActionFalcoEvent").log(function(){return{app_id:t,controller_class:i,cur_state:a,event_type:n,medium:"push",prev_state:o,recip_id:e,source:"web_settings_page"}})}function m(){s!=null&&s.xout_count===0&&u&&o("QE2Logger").logExposureForUser(u)}function p(e){var t=r("XBrowserPushXOutController").getURIBuilder().getURI();new(r("AsyncRequest"))().setURI(t).setMethod("POST").send(),c("xout",e)}function _(e,t){var n=r("PushRegistration").get(e,t);return n.getSubscription()}function f(e,t){var n=r("PushRegistration").get(e,t);return c("turn_off",t),n.unregisterPushAndSW(r("XBrowserPushDisabledController"),r("AsyncRequest"))}function g(e,t,n,o,a){var i=r("PushRegistration").get(e,t);return c("turn_on",t),i.registerPushAndWaitForEndpoint(r("XPushRegisterServiceWorkerController"),r("AsyncRequest"),o).then(function(){r("PushNotificationsEventEmitter").emit("closeInstallPush"),c("install",t),a==null||a()}).catch(function(e){r("PushNotificationsEventEmitter").emit("closeInstallPush"),r("PushRegistration").pushPermissionIsDenied()?(r("PushNotificationsEventEmitter").emit("openPushBlockedNotice",n),c("deny",t)):c("install_ignore",t),p(t)})}function h(t,o,a,i,l,s,u,c){var d=r("PushRegistration").get(t,o),p=d.isPushRegistered(a,r("XPushRegisterServiceWorkerController"),r("XBrowserPushDisabledController"),r("AsyncRequest"),!!l,u);(e||(e=n("Promise"))).all([p,r("incognito")()]).then(function(e){var n=e[0],a=e[1];if(!(n||a))if(m(),r("PushRegistration").pushPermissionIsPending()){if(!c||i)return;r("PushNotificationsEventEmitter").emit("openInstallPush",{appID:o,browserName:s,path:t,workerIsForPushOnly:u})}else i||r("promiseDone")(g(t,o,s,u))}).catch(function(){r("PushNotificationsEventEmitter").emit("closeInstallPush"),r("PushRegistration").pushPermissionIsDenied()&&m()})}function y(e){s=e}function C(e){u=e}l.logUserSettingAction=d,l.genPushSubscription=_,l.genDisableNotifications=f,l.genEnableNotifications=g,l.installPush=h,l.setLogExtraData=y,l.setQEUniverseName=C}),98);
__d("BrowserPushMessageRedirectUtil",["Bootloader"],(function(t,n,r,o,a,i,l){function e(e){var t="(messages)(.*?)(?:(tid=))([^&]*)",n=e.match(t);if(!n)return!0;var o=n.pop();return r("Bootloader").loadModules(["FantaTabActions"],function(e){e.openTab(o)},"BrowserPushMessageRedirectUtil"),!1}l.default=e}),98);
__d("LoginDialog",["Cookie","setInterval"],(function(t,n,r,o,a,i,l){function e(){r("setInterval")(function(){r("Cookie").get("c_user")&&window.location.reload()},5e3)}function s(){window.location.reload()}l.pollLoginCookies=e,l.onClose=s}),98);
__d("legacy:cookie",["Cookie"],(function(t,n,r,o,a,i){t.getCookie=n("Cookie").get,t.setCookie=n("Cookie").set,t.clearCookie=n("Cookie").clear}),3);